<!doctype html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Woordspel voor Amy</title>
  <style>
    :root {
      --bg-a: #fff7ed;
      --bg-b: #dbeafe;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #334155;
      --brand: #0ea5e9;
      --brand-2: #f59e0b;
      --ok: #16a34a;
      --bad: #dc2626;
      --border: #cbd5e1;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 1rem;
      font-family: "Trebuchet MS", "Comic Sans MS", sans-serif;
      color: var(--text);
      background:
        radial-gradient(circle at 15% 15%, #fde68a 0%, transparent 42%),
        radial-gradient(circle at 85% 0%, #bfdbfe 0%, transparent 32%),
        linear-gradient(145deg, var(--bg-a), var(--bg-b));
    }

    .app {
      width: min(760px, 100%);
      background: var(--card);
      border-radius: 18px;
      padding: 1.2rem;
      box-shadow: 0 16px 36px rgba(15, 23, 42, 0.16);
    }

    h1 {
      margin: 0 0 0.45rem;
      font-size: clamp(1.55rem, 3vw, 2.2rem);
    }

    .subtitle {
      margin: 0 0 1rem;
      color: var(--muted);
      font-weight: 600;
    }

    .panel {
      border: 2px solid var(--border);
      border-radius: 14px;
      padding: 1rem;
    }

    .hidden { display: none; }

    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 0.6rem;
      margin-top: 0.6rem;
    }

    .test-btn,
    .next-btn,
    .restart-btn,
    .hint-btn {
      border: 0;
      border-radius: 12px;
      padding: 0.68rem 0.9rem;
      font-weight: 800;
      cursor: pointer;
      font-size: 0.98rem;
    }

    .test-btn,
    .next-btn,
    .restart-btn {
      background: linear-gradient(120deg, var(--brand), var(--brand-2));
      color: #ffffff;
    }

    .hint-btn {
      background: #e2e8f0;
      color: #0f172a;
      margin-top: 0.5rem;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.45rem 0.8rem;
      margin-bottom: 0.8rem;
      font-weight: 700;
      color: #1e293b;
    }

    .word {
      font-size: clamp(1.6rem, 4vw, 2.3rem);
      margin: 0.2rem 0 0.7rem;
      text-align: center;
      color: #075985;
      font-weight: 900;
      letter-spacing: 0.02em;
    }

    .hint {
      margin: 0.45rem 0 0.8rem;
      border-left: 5px solid #38bdf8;
      background: #f0f9ff;
      padding: 0.55rem 0.7rem;
      border-radius: 8px;
      color: #0c4a6e;
      font-weight: 700;
    }

    .options {
      display: grid;
      gap: 0.6rem;
    }

    .option {
      width: 100%;
      text-align: left;
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 0.72rem;
      background: #fff;
      color: #0f172a;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.12s ease, border-color 0.12s ease;
    }

    .option:hover:not(:disabled) {
      transform: translateY(-1px);
      border-color: var(--brand);
    }

    .option.correct {
      border-color: var(--ok);
      background: #dcfce7;
    }

    .option.wrong {
      border-color: var(--bad);
      background: #fee2e2;
    }

    .option:disabled {
      cursor: default;
      opacity: 0.96;
    }

    .feedback {
      min-height: 1.5rem;
      margin-top: 0.85rem;
      font-weight: 800;
    }

    .feedback.good { color: var(--ok); }
    .feedback.bad { color: var(--bad); }

    .footer-btns {
      display: flex;
      gap: 0.6rem;
      margin-top: 0.45rem;
      flex-wrap: wrap;
    }

    .summary {
      text-align: center;
      font-weight: 700;
      color: #0f172a;
    }
  </style>
</head>
<body>
  <main class="app" aria-live="polite">
    <h1>Woordspel voor Amy</h1>
    <p class="subtitle">Groep 6: kies de juiste betekenis. Foute woorden komen later terug, tot je ze goed hebt.</p>

    <section id="startScreen" class="panel">
      <h2>Kies een toets</h2>
      <p>Er zijn 5 toetsen. Elke toets start met 30 woorden.</p>
      <div class="test-grid" id="testGrid"></div>
    </section>

    <section id="quizScreen" class="panel hidden">
      <div class="stats">
        <span id="testLabel">Toets 1 van 5</span>
        <span id="seedCount">Startvragen: 30</span>
        <span id="progressLabel">Vraag 1</span>
        <span id="masteredLabel">Goed: 0 / 30</span>
        <span id="repeatsLabel">Herhalingen: 0</span>
        <span id="mistakesLabel">Fouten: 0</span>
      </div>

      <p class="word" id="word">woord</p>
      <button class="hint-btn" id="hintBtn" type="button">Toon tip</button>
      <p class="hint hidden" id="hintText"></p>
      <div class="options" id="options"></div>
      <p class="feedback" id="feedback"></p>
      <div class="footer-btns">
        <button class="next-btn hidden" id="nextBtn" type="button">Volgende vraag</button>
      </div>
    </section>

    <section id="resultScreen" class="panel hidden summary">
      <h2 id="resultTitle">Toets afgerond</h2>
      <p id="resultText"></p>
      <div class="footer-btns" style="justify-content:center;">
        <button class="next-btn" id="nextTestBtn" type="button">Volgende toets</button>
        <button class="restart-btn" id="restartBtn" type="button">Opnieuw vanaf toets 1</button>
      </div>
    </section>
  </main>

  <script>
    const TESTS = [
      [
        { word: "aandachtig", meaning: "goed opletten", hint: "Je kijkt en luistert heel goed." },
        { word: "afspraak", meaning: "iets dat je samen hebt afgesproken", hint: "Bijvoorbeeld een tijd waarop je elkaar ziet." },
        { word: "antwoord", meaning: "reactie op een vraag", hint: "Wat je zegt nadat iemand iets vraagt." },
        { word: "bewaren", meaning: "niet weggooien en houden", hint: "Je doet het in een doos voor later." },
        { word: "belangrijk", meaning: "iets dat veel betekenis heeft", hint: "Dit moet je zeker niet vergeten." },
        { word: "beslissen", meaning: "een keuze maken", hint: "Je kiest tussen twee of meer dingen." },
        { word: "bezoeken", meaning: "ergens naartoe gaan om iemand te zien", hint: "Bijvoorbeeld bij opa en oma langsgaan." },
        { word: "betekenen", meaning: "de betekenis hebben van", hint: "Wat een woord inhoudt." },
        { word: "bewegen", meaning: "van plaats veranderen", hint: "Niet stil blijven staan." },
        { word: "duidelijk", meaning: "goed te begrijpen", hint: "Het is helder uitgelegd." },
        { word: "eerlijk", meaning: "de waarheid vertellen", hint: "Geen leugens vertellen." },
        { word: "eenvoudig", meaning: "niet moeilijk", hint: "Makkelijk te doen." },
        { word: "ervaring", meaning: "iets dat je hebt meegemaakt", hint: "Daar heb je van geleerd." },
        { word: "fout", meaning: "niet juist", hint: "Het goede antwoord is iets anders." },
        { word: "geheim", meaning: "iets dat niet iedereen mag weten", hint: "Je houdt het voor jezelf." },
        { word: "geloven", meaning: "denken dat iets waar is", hint: "Je vertrouwt erop dat het klopt." },
        { word: "genieten", meaning: "veel plezier hebben van iets", hint: "Je vindt het heel fijn." },
        { word: "gewoonte", meaning: "iets dat je vaak op dezelfde manier doet", hint: "Zoals elke dag je tanden poetsen." },
        { word: "gierig", meaning: "niet graag delen", hint: "Je houdt alles liever zelf." },
        { word: "handig", meaning: "goed in doen of maken", hint: "Je kunt iets snel en slim." },
        { word: "herhalen", meaning: "opnieuw doen", hint: "Nog een keer hetzelfde." },
        { word: "hulp", meaning: "ondersteuning bij iets", hint: "Iemand helpt je met een taak." },
        { word: "idee", meaning: "een plan of gedachte", hint: "Een nieuw voorstel in je hoofd." },
        { word: "kiezen", meaning: "een keuze maken", hint: "Je pakt er een uit meerdere." },
        { word: "luisteren", meaning: "goed horen wat iemand zegt", hint: "Je bent stil en let op de stem." },
        { word: "moedig", meaning: "dapper en niet snel bang", hint: "Je durft iets spannends." },
        { word: "netjes", meaning: "ordelijk en verzorgd", hint: "Geen rommel." },
        { word: "ontdekken", meaning: "iets vinden dat je nog niet kende", hint: "Je merkt iets nieuws op." },
        { word: "oefenen", meaning: "iets vaak doen om beter te worden", hint: "Door training word je sterker." },
        { word: "oplossen", meaning: "een probleem goed maken", hint: "Je vindt de juiste uitkomst." }
      ],
      [
        { word: "apart", meaning: "anders dan de rest", hint: "Het valt op omdat het niet hetzelfde is." },
        { word: "beschrijven", meaning: "met woorden uitleggen hoe iets is", hint: "Je vertelt precies wat je ziet." },
        { word: "bewonderen", meaning: "iets heel mooi of knap vinden", hint: "Je kijkt met veel respect." },
        { word: "bezorgd", meaning: "ongerust", hint: "Je maakt je zorgen." },
        { word: "bloeien", meaning: "bloemen krijgen", hint: "Planten krijgen kleurige blaadjes." },
        { word: "dalen", meaning: "omlaag gaan", hint: "Het wordt minder of lager." },
        { word: "druk", meaning: "veel bezig of vol", hint: "Er gebeurt veel tegelijk." },
        { word: "duurzaam", meaning: "goed voor lang gebruik en natuur", hint: "Je gebruikt iets zonder veel afval." },
        { word: "eigenschap", meaning: "kenmerk van iemand of iets", hint: "Bijvoorbeeld vriendelijk of snel." },
        { word: "fantasie", meaning: "dingen bedenken die niet echt zijn", hint: "Je verbeelding gebruiken." },
        { word: "fris", meaning: "nieuw en schoon of koel", hint: "Net gewassen lucht of kleren." },
        { word: "geduldig", meaning: "rustig kunnen wachten", hint: "Niet meteen boos worden." },
        { word: "gevaar", meaning: "kans dat er iets misgaat", hint: "Oppassen, dit kan fout aflopen." },
        { word: "glad", meaning: "zonder ruwe stukjes", hint: "Je kunt er snel op uitglijden." },
        { word: "grappig", meaning: "om te lachen", hint: "Het is heel komisch." },
        { word: "helder", meaning: "duidelijk en goed te zien", hint: "Niet troebel of wazig." },
        { word: "hinderlijk", meaning: "lastig en storend", hint: "Het maakt iets moeilijker." },
        { word: "juichen", meaning: "hard roepen van blijdschap", hint: "Bij een doelpunt doe je dit." },
        { word: "kalm", meaning: "rustig en niet druk", hint: "Je blijft ontspannen." },
        { word: "krachtig", meaning: "sterk", hint: "Met veel power." },
        { word: "kwetsbaar", meaning: "snel pijn of schade kunnen krijgen", hint: "Niet goed beschermd." },
        { word: "leeg", meaning: "zonder inhoud", hint: "Er zit niets in." },
        { word: "mening", meaning: "wat jij ergens van vindt", hint: "Jouw eigen oordeel." },
        { word: "natuurlijk", meaning: "uit de natuur of vanzelf", hint: "Niet nep gemaakt." },
        { word: "ongeveer", meaning: "bij benadering", hint: "Niet precies, maar bijna." },
        { word: "opluchting", meaning: "fijn gevoel als spanning weg is", hint: "Je bent blij dat het voorbij is." },
        { word: "passen", meaning: "de goede maat of vorm hebben", hint: "Een trui is niet te groot of te klein." },
        { word: "proberen", meaning: "een poging doen", hint: "Je test of het lukt." },
        { word: "ruiken", meaning: "met je neus waarnemen", hint: "Bijvoorbeeld de geur van soep." },
        { word: "tevreden", meaning: "blij met hoe iets is", hint: "Je bent er content mee." }
      ],
      [
        { word: "achterlaten", meaning: "niet meenemen en ergens laten", hint: "Je gaat weg en het blijft daar." },
        { word: "bedoeling", meaning: "wat je van plan bent", hint: "Waarom je iets doet." },
        { word: "begeleiden", meaning: "met iemand meegaan om te helpen", hint: "Je loopt mee en ondersteunt." },
        { word: "bekend", meaning: "door veel mensen gekend", hint: "Veel mensen weten wie of wat het is." },
        { word: "benodigd", meaning: "nodig om iets te doen", hint: "Zonder dit lukt de taak niet." },
        { word: "beoordelen", meaning: "een oordeel geven over iets", hint: "Je zegt hoe goed of slecht het is." },
        { word: "bereiken", meaning: "ergens aankomen of iets halen", hint: "Je komt op je doel uit." },
        { word: "beschermen", meaning: "zorgen dat iets veilig blijft", hint: "Je houdt gevaar weg." },
        { word: "bewijs", meaning: "iets dat laat zien dat het waar is", hint: "Een foto kan dit zijn." },
        { word: "blindelings", meaning: "zonder goed na te denken of kijken", hint: "Je doet het zomaar." },
        { word: "brutaal", meaning: "onbeleefd en te vrij", hint: "Je praat niet netjes terug." },
        { word: "denkbeeldig", meaning: "alleen in je gedachten bestaand", hint: "Het is niet echt." },
        { word: "eerbied", meaning: "respect", hint: "Je behandelt iets met veel waardering." },
        { word: "eindeloos", meaning: "zonder duidelijk einde", hint: "Het lijkt maar door te gaan." },
        { word: "gastvrij", meaning: "vriendelijk voor bezoekers", hint: "Je ontvangt mensen warm." },
        { word: "gepast", meaning: "zoals het hoort in die situatie", hint: "Netjes en passend gedrag." },
        { word: "geheimzinnig", meaning: "mysterieus en niet duidelijk", hint: "Je weet niet precies wat er speelt." },
        { word: "geluidloos", meaning: "zonder geluid", hint: "Helemaal stil." },
        { word: "geslaagd", meaning: "gelukt", hint: "Het is succesvol gegaan." },
        { word: "grenzen", meaning: "lijnen waar iets ophoudt", hint: "Tot hier en niet verder." },
        { word: "ijverig", meaning: "hard werkend", hint: "Je zet je goed in." },
        { word: "inleven", meaning: "je voorstellen hoe een ander zich voelt", hint: "Je verplaatst je in iemand anders." },
        { word: "inzicht", meaning: "goed begrip", hint: "Je snapt hoe het in elkaar zit." },
        { word: "lastigvallen", meaning: "iemand steeds storen", hint: "Je laat iemand niet met rust." },
        { word: "opletten", meaning: "goed aandacht geven", hint: "Je concentreert je op wat er gebeurt." },
        { word: "overleggen", meaning: "samen bespreken", hint: "Je praat samen om een besluit te nemen." },
        { word: "plotseling", meaning: "opeens", hint: "Zonder waarschuwing ineens." },
        { word: "respecteren", meaning: "rekening houden met iets of iemand", hint: "Je accepteert de ander zoals die is." },
        { word: "samenvatten", meaning: "kort vertellen wat het belangrijkste is", hint: "De hoofdpunten in weinig woorden." },
        { word: "twijfelen", meaning: "niet zeker weten", hint: "Je weet niet goed welke keuze klopt." }
      ],
      [
        { word: "aanmoedigen", meaning: "iemand extra moed geven", hint: "Je roept: kom op, je kunt het!" },
        { word: "aanpassen", meaning: "veranderen zodat het beter past", hint: "Je maakt het geschikt voor de situatie." },
        { word: "afleiden", meaning: "ervoor zorgen dat iemand niet oplet", hint: "Je aandacht gaat naar iets anders." },
        { word: "afwisselend", meaning: "niet steeds hetzelfde", hint: "Het verandert telkens." },
        { word: "behendig", meaning: "lenig en handig", hint: "Je beweegt slim en snel." },
        { word: "behoorlijk", meaning: "redelijk veel of netjes", hint: "Niet weinig, best goed." },
        { word: "beleefd", meaning: "met goede manieren", hint: "Je zegt netjes dankjewel." },
        { word: "benauwd", meaning: "moeilijk kunnen ademen of angstig voelen", hint: "Het voelt alsof er weinig lucht is." },
        { word: "berucht", meaning: "bekend om iets slechts", hint: "Veel mensen kennen het door slechte naam." },
        { word: "bevestigen", meaning: "laten weten dat iets klopt", hint: "Je zegt: ja, dat is waar." },
        { word: "bijzonder", meaning: "speciaal", hint: "Niet gewoon." },
        { word: "chaotisch", meaning: "rommelig en zonder orde", hint: "Alles ligt door elkaar." },
        { word: "dapper", meaning: "moedig", hint: "Je durft ondanks spanning." },
        { word: "deugdelijk", meaning: "stevig en goed genoeg", hint: "Het is van goede kwaliteit." },
        { word: "doelgericht", meaning: "werken naar een duidelijk doel", hint: "Je weet precies wat je wilt bereiken." },
        { word: "dringend", meaning: "iets dat snel moet gebeuren", hint: "Wachten is geen goed idee." },
        { word: "eigenwijs", meaning: "alleen je eigen zin willen", hint: "Je luistert weinig naar advies." },
        { word: "feller", meaning: "sterker en scherper", hint: "Meer kracht of kleur dan eerst." },
        { word: "gevoelig", meaning: "snel iets voelen of merken", hint: "Je reageert snel op prikkels." },
        { word: "gespannen", meaning: "zenuwachtig", hint: "Je voelt spanning in je lijf." },
        { word: "grondig", meaning: "heel zorgvuldig en volledig", hint: "Niets overslaan." },
        { word: "hartelijk", meaning: "vriendelijk en warm", hint: "Je ontvangt iemand met open houding." },
        { word: "ingewikkeld", meaning: "moeilijk te begrijpen", hint: "Er zitten veel lastige stukjes aan." },
        { word: "koppig", meaning: "niet willen toegeven", hint: "Je blijft bij je eigen standpunt." },
        { word: "nadrukkelijk", meaning: "heel duidelijk en met klem", hint: "Je legt ergens sterke nadruk op." },
        { word: "onhandig", meaning: "niet zo handig", hint: "Dingen gaan snel mis." },
        { word: "oprecht", meaning: "eerlijk en echt gemeend", hint: "Niet nep of gespeeld." },
        { word: "scherp", meaning: "puntig of snel van begrip", hint: "Een mes kan dit zijn, je geest ook." },
        { word: "slordig", meaning: "niet netjes", hint: "Veel rommel of fouten." },
        { word: "standvastig", meaning: "niet snel van mening veranderen", hint: "Je blijft stevig bij je keuze." }
      ],
      [
        { word: "aanzienlijk", meaning: "best veel of groot", hint: "Meer dan je eerst dacht." },
        { word: "bewust", meaning: "met aandacht en nadenken", hint: "Je doet iets niet zomaar." },
        { word: "boeien", meaning: "interessant zijn", hint: "Je wilt blijven luisteren of kijken." },
        { word: "bundelen", meaning: "samenvoegen", hint: "Losse dingen maak je een geheel." },
        { word: "concentreren", meaning: "je aandacht op een ding richten", hint: "Je laat je niet afleiden." },
        { word: "daadkrachtig", meaning: "snel en stevig handelen", hint: "Je blijft niet lang twijfelen." },
        { word: "doorzetten", meaning: "verdergaan ook als het moeilijk is", hint: "Niet opgeven." },
        { word: "eisen", meaning: "iets streng verlangen", hint: "Je zegt dat iets echt moet." },
        { word: "eindresultaat", meaning: "uitkomst aan het einde", hint: "Wat je overhoudt als alles klaar is." },
        { word: "erkentelijk", meaning: "dankbaar", hint: "Je bent blij met hulp die je kreeg." },
        { word: "fascinerend", meaning: "heel boeiend", hint: "Je kunt er bijna niet van wegkijken." },
        { word: "gegrond", meaning: "met goede reden", hint: "Het klopt op basis van feiten." },
        { word: "geregeld", meaning: "vaak of op orde gemaakt", hint: "Het gebeurt telkens of is goed gepland." },
        { word: "geruststellen", meaning: "iemand kalmer maken", hint: "Je neemt zorgen weg." },
        { word: "grotendeels", meaning: "voor het grootste deel", hint: "Niet helemaal, maar bijna alles." },
        { word: "inmiddels", meaning: "nu, na verloop van tijd", hint: "Er is tijd voorbijgegaan." },
        { word: "kritisch", meaning: "goed beoordelend en vragend", hint: "Je kijkt scherp of iets klopt." },
        { word: "leerzaam", meaning: "waar je iets van leert", hint: "Je wordt er slimmer van." },
        { word: "merkwaardig", meaning: "vreemd of opvallend", hint: "Het is anders dan normaal." },
        { word: "nauwkeurig", meaning: "precies en met aandacht", hint: "Je werkt heel zorgvuldig." },
        { word: "onverwacht", meaning: "zonder dat je het zag aankomen", hint: "Je had het niet voorspeld." },
        { word: "overtuigen", meaning: "zorgen dat iemand je gelooft", hint: "Je geeft sterke argumenten." },
        { word: "praktisch", meaning: "handig in het echt gebruik", hint: "Je kunt het meteen toepassen." },
        { word: "realistisch", meaning: "zoals het echt kan", hint: "Niet te mooi om waar te zijn." },
        { word: "redeneren", meaning: "stap voor stap nadenken", hint: "Je gebruikt logische gedachten." },
        { word: "samenwerken", meaning: "met anderen werken aan hetzelfde doel", hint: "Je doet het als team." },
        { word: "sober", meaning: "eenvoudig en zonder extra's", hint: "Niet luxe of druk." },
        { word: "toepassen", meaning: "iets gebruiken in de praktijk", hint: "Je zet kennis echt in." },
        { word: "uitzondering", meaning: "iets dat anders is dan normaal", hint: "Een regel met een speciale afwijking." },
        { word: "zelfstandig", meaning: "zonder hulp van anderen", hint: "Je kunt het alleen doen." }
      ]
    ];

    const startScreen = document.getElementById("startScreen");
    const quizScreen = document.getElementById("quizScreen");
    const resultScreen = document.getElementById("resultScreen");
    const testGrid = document.getElementById("testGrid");

    const testLabel = document.getElementById("testLabel");
    const seedCount = document.getElementById("seedCount");
    const progressLabel = document.getElementById("progressLabel");
    const masteredLabel = document.getElementById("masteredLabel");
    const repeatsLabel = document.getElementById("repeatsLabel");
    const mistakesLabel = document.getElementById("mistakesLabel");

    const wordEl = document.getElementById("word");
    const hintBtn = document.getElementById("hintBtn");
    const hintText = document.getElementById("hintText");
    const optionsEl = document.getElementById("options");
    const feedbackEl = document.getElementById("feedback");
    const nextBtn = document.getElementById("nextBtn");

    const resultTitle = document.getElementById("resultTitle");
    const resultText = document.getElementById("resultText");
    const nextTestBtn = document.getElementById("nextTestBtn");
    const restartBtn = document.getElementById("restartBtn");

    const TOTAL_TESTS = TESTS.length;
    const BASE_QUESTIONS_PER_TEST = 30;

    const state = {
      currentTestIndex: null,
      queue: [],
      currentQuestion: null,
      attempts: 0,
      mistakes: 0,
      mastered: 0,
      repeats: 0
    };

    function shuffle(arr) {
      const copy = [...arr];
      for (let i = copy.length - 1; i > 0; i -= 1) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function hide(el) {
      el.classList.add("hidden");
    }

    function show(el) {
      el.classList.remove("hidden");
    }

    function getDistractors(allQuestions, correctMeaning) {
      const wrongMeanings = allQuestions
        .map((q) => q.meaning)
        .filter((meaning) => meaning !== correctMeaning);
      return shuffle(wrongMeanings).slice(0, 3);
    }

    function makeQuestionCard(question, allQuestions) {
      return {
        ...question,
        options: shuffle([question.meaning, ...getDistractors(allQuestions, question.meaning)])
      };
    }

    function buildTestButtons() {
      testGrid.innerHTML = "";
      for (let i = 0; i < TOTAL_TESTS; i += 1) {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "test-btn";
        btn.textContent = `Toets ${i + 1}`;
        btn.addEventListener("click", () => startTest(i));
        testGrid.appendChild(btn);
      }
    }

    function startTest(index) {
      const testData = TESTS[index];
      state.currentTestIndex = index;
      state.queue = shuffle(testData).map((q) => makeQuestionCard(q, testData));
      state.currentQuestion = null;
      state.attempts = 0;
      state.mistakes = 0;
      state.mastered = 0;
      state.repeats = 0;

      hide(startScreen);
      hide(resultScreen);
      show(quizScreen);
      renderNextQuestion();
    }

    function updateStats() {
      const testNumber = state.currentTestIndex + 1;
      testLabel.textContent = `Toets ${testNumber} van ${TOTAL_TESTS}`;
      seedCount.textContent = `Startvragen: ${BASE_QUESTIONS_PER_TEST}`;
      progressLabel.textContent = `Beurten: ${state.attempts}`;
      masteredLabel.textContent = `Goed: ${state.mastered} / ${BASE_QUESTIONS_PER_TEST}`;
      repeatsLabel.textContent = `Herhalingen: ${state.repeats}`;
      mistakesLabel.textContent = `Fouten: ${state.mistakes}`;
    }

    function renderQuestion() {
      const q = state.currentQuestion;
      wordEl.textContent = q.word;
      hintText.textContent = `Tip: ${q.hint}`;
      hide(hintText);
      hintBtn.textContent = "Toon tip";
      optionsEl.innerHTML = "";
      feedbackEl.textContent = "";
      feedbackEl.className = "feedback";
      hide(nextBtn);

      q.options.forEach((optionText) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "option";
        btn.textContent = optionText;
        btn.addEventListener("click", () => handleAnswer(btn, optionText));
        optionsEl.appendChild(btn);
      });

      updateStats();
    }

    function renderNextQuestion() {
      if (state.queue.length === 0) {
        finishTest();
        return;
      }

      state.currentQuestion = state.queue.shift();
      state.attempts += 1;
      renderQuestion();
    }

    function disableOptions() {
      return Array.from(document.querySelectorAll(".option")).map((btn) => {
        btn.disabled = true;
        return btn;
      });
    }

    function handleAnswer(clickedButton, selectedMeaning) {
      const q = state.currentQuestion;
      const buttons = disableOptions();
      const correct = selectedMeaning === q.meaning;

      buttons.forEach((btn) => {
        if (btn.textContent === q.meaning) {
          btn.classList.add("correct");
        }
      });

      if (correct) {
        state.mastered += 1;
        clickedButton.classList.add("correct");
        feedbackEl.textContent = "Goed gedaan! Dit woord is nu gehaald.";
        feedbackEl.classList.add("good");
      } else {
        state.mistakes += 1;
        state.repeats += 1;
        clickedButton.classList.add("wrong");
        feedbackEl.textContent = `Niet goed. Het juiste antwoord is: ${q.meaning}. Dit woord komt later terug.`;
        feedbackEl.classList.add("bad");
        state.queue.push(makeQuestionCard(q, TESTS[state.currentTestIndex]));
      }

      updateStats();
      show(nextBtn);
    }

    function finishTest() {
      hide(quizScreen);
      show(resultScreen);

      const testNumber = state.currentTestIndex + 1;
      resultTitle.textContent = `Toets ${testNumber} afgerond`;
      resultText.textContent = `Knap gewerkt. Je hebt alle 30 woorden goed gemaakt. Totaal beurten: ${state.attempts}. Fouten onderweg: ${state.mistakes}.`;

      if (testNumber >= TOTAL_TESTS) {
        nextTestBtn.textContent = "Alle toetsen klaar";
        nextTestBtn.disabled = true;
      } else {
        nextTestBtn.textContent = `Start toets ${testNumber + 1}`;
        nextTestBtn.disabled = false;
      }
    }

    hintBtn.addEventListener("click", () => {
      const hidden = hintText.classList.contains("hidden");
      if (hidden) {
        show(hintText);
        hintBtn.textContent = "Verberg tip";
      } else {
        hide(hintText);
        hintBtn.textContent = "Toon tip";
      }
    });

    nextBtn.addEventListener("click", renderNextQuestion);

    nextTestBtn.addEventListener("click", () => {
      if (state.currentTestIndex + 1 < TOTAL_TESTS) {
        startTest(state.currentTestIndex + 1);
      }
    });

    restartBtn.addEventListener("click", () => {
      hide(resultScreen);
      hide(quizScreen);
      show(startScreen);
      buildTestButtons();
    });

    buildTestButtons();
  </script>
</body>
</html>
